{
  "id": "gbhackers-security-1-globally-trusted-cyber-security-news-platform-gbhackers-com-2025-11-03-f269ae27",
  "source_id": "gbhackers-security-1-globally-trusted-cyber-security-news-platform-gbhackers-com",
  "guid": "https://gbhackers.com/?p=167910",
  "title": "New BOF Tool Bypasses Microsoft Teams Cookie Encryption to Steal User Chats",
  "url": "https://gbhackers.com/new-bof-tool-bypasses-microsoft-teams-cookie-encryption/",
  "published_at": "2025-11-03T10:13:33+00:00",
  "fetched_at": "2025-11-03T11:15:04.410035Z",
  "status": "processed",
  "content": {
    "raw": "Cybersecurity researchers at Tier Zero Security have released a specialised Beacon Object File (BOF) tool that exploits a critical weakness in Microsoft Teams cookie encryption, enabling attackers to steal user chat messages and other sensitive communications. The vulnerability stems from how Microsoft Teams handles cookie encryption compared to modern Chromium-based browsers. While contemporary browsers like [&#8230;] The post New BOF Tool Bypasses Microsoft Teams Cookie Encryption to Steal User Chats appeared first on GBHackers Security | #1 Globally Trusted Cyber Security News Platform.",
    "full": "Cybersecurity researchers at Tier Zero Security have released a specialised Beacon Object File (BOF) tool that exploits a critical weakness in Microsoft Teams cookie encryption, enabling attackers to steal user chat messages and other sensitive communications.\nThe vulnerability stems from how Microsoft Teams handles cookie encryption compared to modern Chromium-based browsers.\nWhile contemporary browsers like Chrome and Edge invoke a COM-based IElevator service running with SYSTEM privileges to protect encryption keys, Microsoft Teams still relies on the current user’s Data Protection API (DPAPI) master key.\nThis weaker protection mechanism creates an opportunity for attackers to decrypt cookies without requiring elevated administrator privileges.\nMicrosoft Teams uses the msedgewebview2.exe process, a Chromium-based component, to display browser content within the application.\nUpon authentication, Teams stores cookies in a SQLite database similar to regular browsers.\nHowever, the encryption key protecting these cookies can be accessed through the user’s DPAPI master key, making extraction significantly easier for threat actors operating at user-level privileges.\nHow the Attack Works\nThe newly released teams-cookies-bof tool represents a modified version of the existing Cookie-Monster-BOF framework, specifically adapted to target Microsoft Teams.\nThe attack methodology involves running the BOF within the ms-teams.exe process context, where it searches for the web view child process maintaining an open handle to the cookies file.\nThe tool then duplicates this handle, reads the file content, and downloads it while simultaneously decrypting the cookie encryption key using the current user’s DPAPI master key.\nResearchers discovered that previous Teams cookie theft attempts faced limitations because the cookies file remained locked while the Teams application was running.\nThe new BOF approach circumvents this obstacle by operating within the process itself through techniques like DLL or COM hijacking, eliminating the need to kill the Teams process entirely.\nOnce attackers obtain the decrypted cookies, they gain access to authentication tokens that allow interaction with Teams, Skype, and Microsoft Graph APIs.\nThis access enables threat actors to read existing Teams messages, send new messages impersonating the victim, and potentially access other Microsoft 365 resources within the user’s scope.\nThe stolen tokens can be leveraged with post-exploitation tools like GraphSpy to expand the attack surface across Microsoft’s ecosystem.\nThe decryption methodology remains identical to the original Cookie-Monster-BOF tool and supports any Command and Control (C2) framework capable of executing BOF files.\nThis compatibility makes the technique easily adoptable by various threat actors and red team operators.\nOrganizations using Microsoft Teams should implement endpoint detection and response solutions capable of monitoring unusual process behavior, handle duplication activities, and unauthorized access attempts to Teams cookie databases.\nFollow us on Google News, LinkedIn, and X to Get Instant Updates and Set GBH as a Preferred Source in Google.",
    "processed": ""
  },
  "analysis": {
    "score": 80,
    "relevance_score": 90,
    "threat_category": "Credential Theft, Cookie Decryption, Espionage",
    "summary": "Describes a new Beacon Object File (BOF) tool that exploits a weakness in Microsoft Teams cookie encryption, allowing attackers to steal user chat messages and sensitive communications without elevated privileges.",
    "key_entities": [
      "Tier Zero Security",
      "Microsoft Teams",
      "msedgewebview2.exe",
      "DPAPI master key"
    ],
    "ttps": [
      "Cookie decryption via DPAPI master key",
      "Use of BOF tool within ms-teams.exe process",
      "Extraction of cookies from SQLite database",
      "User-level privilege exploitation"
    ]
  },
  "content_source": "enhanced",
  "content_fetch_method": "trafilatura",
  "processing_metadata": {
    "processed_at": "2025-11-03T11:18:43.359348+00:00Z",
    "llm_provider": "unknown",
    "processing_method": "json_processing"
  },
  "updated_at": "2025-11-03T11:18:43.359854Z"
}
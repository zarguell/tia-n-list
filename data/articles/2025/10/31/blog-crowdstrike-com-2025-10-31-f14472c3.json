{
  "id": "blog-crowdstrike-com-2025-10-31-f14472c3",
  "source_id": "blog-crowdstrike-com",
  "guid": "https://www.crowdstrike.com/?p=377024",
  "title": "From Domain User to SYSTEM: Analyzing the NTLM LDAP Authentication Bypass Vulnerability (CVE-2025-54918)",
  "url": "https://www.crowdstrike.com/en-us/blog/analyzing-ntlm-ldap-authentication-bypass-vulnerability/",
  "published_at": "2025-10-31T11:14:48.207702+00:00",
  "fetched_at": "2025-10-31T11:14:48.208183Z",
  "status": "processed",
  "content": {
    "raw": "",
    "full": "Coerced Authentication\nCoerced authentication is a procedure where attackers trigger a remote authentication to a compromised machine. When the attackers capture the network login on the compromised machine, they can use this authentication to perform:\n- Password cracking\n- Credentials relay (NTLM/Kerberos relay)\nTwo well-known examples of authentication coercion attacks are:\n- \"Printer Bug\": Discovered by Lee Christensen from SpecterOps in 2018, this vulnerability in the print spooler service enables attackers to trigger authentication by a remote host's computer account. If the remote machine is privileged (e.g., a domain controller), that authentication can be relayed and the computer account privileges are used. This is often chained with NTLM relay attacks against Active Directory Certificate Services (AD CS) for domain compromise.\n- PetitPotam: This is a similar coercion technique that exploits the MS-EFSRPC protocol to force Windows hosts to authenticate to arbitrary targets.\nCVE-2025-54918 represents a new evolution in these attack techniques, combining NTLM relay manipulation with authentication coercion to bypass even robust security controls, making it particularly dangerous in modern Active Directory environments.\nUnderstanding CVE-2025-54918\nCVE-2025-54918 represents a critical security vulnerability that combines coercion techniques with NTLM relay manipulation to achieve domain controller compromise. Attackers can leverage a coercion attack (e.g., the Printer Bug exploit) to initiate an authentication attempt from the domain controller, then modify some fields in the authentication packets and relay this authentication to gain elevated privileges. The attack is particularly concerning as it bypasses traditional security controls like channel binding and LDAP signing requirements, making it effective even in environments with standard hardening measures in place.\nTechnical Attack Flow\nPreparation\nThe initial reconnaissance and setup phase requires minimal resources but careful planning. The attack requires only a low-privileged domain user account, which can often be obtained through means such as password spraying, credential theft, or social engineering attacks. During this phase, the attacker conducts network reconnaissance to identify target domain controllers running LDAP or LDAPS services, typically scanning ports (389 or 636) or using tools like NetExec with the module ldap-checker\nto verify if LDAP or LDAPS service is running and requires channel binding or not.\nThe attacker then establishes a malicious listener infrastructure on a system they control that has connectivity to the target domain controller, configuring it to capture and manipulate incoming NTLM authentication attempts. This listener must be positioned to intercept network traffic and be able to modify authentication packets in real time.\nCoercion\nThe coercion phase exploits the well-documented Printer Bug vulnerability through the Microsoft Print System Remote Protocol (MS-RPRN) interface. The attacker uses this remote protocol to establish a connection with the target domain controller's print spooler service, which runs with SYSTEM privileges.\nBy sending a specially crafted RPC call to the print spooler (RpcRemoteFindFirstPrinterChangeNotificationEx), the attacker forces the domain controller to initiate an outbound authentication attempt to the attacker-controlled system. This coerced authentication attempt carries distinctive characteristics that are crucial for the subsequent exploitation phases:\n- Empty username fields that indicate the authentication is originating from a SYSTEM account\n- LOCAL_CALL flag set in the NTLM negotiation, signifying that the authentication request is being treated as a local system call\n- SEAL and SIGN flags are set in the NTLM negotiation, indicating the authentication session requires message signing and sealing\n- The authentication attempt uses the domain controller's machine account credentials\nAuthentication Manipulation\nDuring this critical phase, the attacker intercepts the domain controller's authentication attempt using their malicious listener infrastructure. The attacker then performs manipulation of the NTLM authentication packet structure, specifically targeting the security flags that govern the authentication process. The manipulation involves removing specific security flags while preserving others:\n- Removes SEAL flag: This eliminates the requirement for message encryption, allowing the attacker to process and relay the authentication in plaintext\n- Removes SIGN flag: This bypasses message integrity verification, preventing the domain controller from detecting that the authentication has been tampered with\n- Preserves LOCAL_CALL flag: This crucial flag must remain intact as it signals to the receiving system that the authentication should be treated as a local system call rather than a remote network authentication\nThis manipulation effectively bypasses multiple layers of security controls, including channel binding mechanisms and signing requirements that would normally prevent such attacks.\nRelay Attack Execution\nThe modified authentication packet is then strategically relayed back to the originating domain controller using the LDAP/LDAPS protocol as the relay target. This creates a man-in-the-middle scenario where the domain controller unknowingly authenticates against itself through the attacker's infrastructure. The domain controller processes this relayed authentication as a legitimate local authentication due to several factors:\n- The preserved LOCAL_CALL flag convinces the authentication subsystem that this is a local system call\n- The modified security flags allow for unsigned communication, bypassing normal security verification processes\n- The empty username field is indicating the authentication is originating from a SYSTEM account\nThe LDAP/LDAPS protocol provides the necessary interface for the attacker to execute privileged operations once authentication succeeds.\nPrivilege Escalation\nUpon successful completion of the relay attack, the attacker achieves SYSTEM-level access to the domain controller, representing the highest possible privilege level on the system. This escalation effectively bypasses multiple traditional security controls that organizations typically rely upon for protection:\n- Channel binding: Normally prevents authentication relay attacks by cryptographically binding the authentication to the specific network channel\n- LDAP signing requirements: Usually ensures all LDAP communications are digitally signed to prevent tampering\nWith SYSTEM-level access achieved, the attacker gains complete control over the domain controller, enabling them to perform any administrative action including creating new accounts, modifying group memberships, accessing sensitive data, and potentially compromising the entire Active Directory forest.\nDetection Strategy and Technical Analysis\nDetecting CVE-2025-54918 exploitation attempts requires implementing a multi-layered monitoring strategy that focuses on anomalous authentication patterns within Active Directory environments. The sophisticated nature of this vulnerability demands advanced detection techniques that go beyond traditional signature-based approaches.\nSecurity teams must configure their monitoring infrastructure to capture and analyze NTLM authentication traffic, particularly focusing on communications involving LDAP/LDAPS protocols. This comprehensive approach ensures exploitation attempts can be identified through specific technical indicators before they result in successful privilege escalation.\nTechnical Indicators and Forensic Artifacts\nOur research and analysis have identified several specific technical indicators that can reliably detect exploitation attempts targeting this vulnerability. These indicators represent unique fingerprints left by the attack methodology and provide high-confidence detection opportunities:\n- Empty username fields in NTLM authentication attempts: This represents one of the most distinctive indicators of the attack, as legitimate user authentication processes typically include populated username fields. The presence of empty username fields in network authentication attempts should trigger immediate investigation.\n- LOCAL_CALL flag presence: The detection of LOCAL_CALL flags in authentication traffic provides a strong indicator of potential exploitation, as this flag should typically only appear in genuine local system authentication contexts, not in network-based authentication scenarios.\n- Modified SEAL and SIGN flags: Monitoring for authentication packets where these critical security flags have been removed or altered indicates potential tampering and relay attack activity. The absence of these flags in contexts where they should be present represents a clear security violation.\n- LDAP/LDAPS protocol usage: Unusual patterns in LDAP or LDAPS protocol utilization, particularly when correlated with the other indicators, can help identify exploitation attempts. Organizations should monitor for unexpected LDAP or LDAPS connections and authentication patterns.\nBuilding upon our research findings, we have developed a specialized correlation rule template (CRT) signature leveraging Falcon platform identity data within Falcon Next-Gen SIEM that can specifically help identify potential CVE-2025-54918 exploitation attempts. Our internal research demonstrates that this signature employs correlation logic that analyzes the technical indicators mentioned above, providing organizations with the tools to support an automated detection capability for this sophisticated attack vector. The CRT signature focuses on identifying combinations of these technical indicators within specific timeframes, enabling security teams to detect exploitation attempts with high confidence while minimizing false positive alerts.\nTo implement this detection capability, customers must manually enable the CRT through Falcon Next-Gen SIEM by navigating to NGS -> Monitor and investigate -> Rules -> Templates and searching for the relevant CRT: “CrowdStrike - Identity - Unusual NTLM LDAP Authentication Pattern (CVE-2025-54918)”\nMitigation and Protection Strategies\nThe Falcon platform provides comprehensive protection capabilities that directly address these mitigation strategies.\nFalcon Exposure Management delivers critical visibility for patch management initiatives, enabling organizations to rapidly identify vulnerable systems and prioritize remediation efforts based on actual risk exposure. This capability is essential for implementing the first mitigation strategy effectively, allowing critical patches like the CVE-2025-54918 fix to be deployed systematically across the enterprise.\nFalcon Next-Gen Identity Security provides insights into Active Directory environment configurations, surfacing critical security risks that could enable NTLM relay attacks. It continuously monitors and assesses AD security posture, identifying misconfigurations such as disabled SMB signing, inadequate LDAP signing settings, missing LDAPS channel binding implementations, and Print Spooler service running. These insights enable security teams to proactively address configuration weaknesses before they can be exploited.\nBeyond configuration assessment, Falcon Next-Gen Identity Security delivers account activity monitoring, including detailed NTLM authentication tracking and behavioral analysis. The platform provides specialized NTLM relay detection capabilities that can identify suspicious authentication patterns and potential relay attack attempts in real time.\nConclusion\nCVE-2025-54918 represents a significant threat to organizations by potentially allowing attackers to compromise entire Active Directory environments from a single low-privileged account. Understanding and detecting this attack vector is crucial to maintain security integrity.\nThe comprehensive Falcon platform provides multiple layers of protection:\n- Proactive detection through Falcon Next-Gen SIEM\n- Expert threat hunting through CrowdStrike Falcon® Adversary OverWatch™\nThrough CrowdStrike's integrated security ecosystem, organizations can detect, prevent, and respond to exploitation attempts of CVE-2025-54918 and similar threats, supporting efforts to secure their Active Directory environments.",
    "processed": ""
  },
  "analysis": {
    "score": 90,
    "relevance_score": 95,
    "threat_category": "Active Directory Privilege Escalation",
    "summary": "This article analyzes CVE-2025-54918, a critical NTLM LDAP authentication bypass vulnerability that enables attackers to escalate privileges from domain user to SYSTEM level in Active Directory environments by combining NTLM relay and coerced authentication techniques.",
    "key_entities": [
      "CVE-2025-54918",
      "NTLM relay",
      "Coerced Authentication",
      "Active Directory",
      "Domain Controller",
      "PetitPotam",
      "Printer Bug",
      "CrowdStrike Falcon"
    ],
    "ttps": [
      "Coerced Authentication",
      "NTLM Relay",
      "Privilege Escalation",
      "Authentication Bypass",
      "Active Directory Compromise"
    ]
  },
  "content_source": "enhanced",
  "content_fetch_method": "trafilatura",
  "processing_metadata": {
    "processed_at": "2025-10-31T11:18:13.881561+00:00Z",
    "llm_provider": "unknown",
    "processing_method": "json_processing"
  },
  "updated_at": "2025-10-31T11:18:13.881988Z"
}